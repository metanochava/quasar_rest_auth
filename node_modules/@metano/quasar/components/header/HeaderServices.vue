<template>
  <div>
    <!-- Conteúdo do HeaderServices -->
    <q-btn round dense flat  size="14px" icon="apps">
          <q-tooltip :class="$q.dark.isActive ? 'bg-transparent' : 'bg-primary'" >{{tdc("Serviços")}}</q-tooltip>
          <q-menu flat bordered square  fit :offset="[175, 5]"  >
            <q-card class="my-card"  style="min-width:270px;" >
                <q-card-section class="text-center"   flat bordered square  >
                  <q-scroll-area
                    :thumb-style="thumbStyle"
                    :bar-style="barStyle"
                    style="height: 300px"
                  >
                    <div class="row col-xs-12"  >
                      <div  v-for=" te in Auth?.TipoEntidades" :key="te">
                        <q-item   v-close-popup   flat bordered   class="col-4 " v-if="getHostname(te)"  >
                          <q-item-label  clickable @click="selectteidadeLink(te)"  class="localhover">
                            <q-avatar class="" size="45px" style="border-radius:5px;" >
                              <img :src="te?.icon?.url" >
                            </q-avatar>
                            <br>
                            {{tdc(te.nome)}}
                          </q-item-label>
                        </q-item  >
                        </div>
                    </div>
                  </q-scroll-area>
                </q-card-section>
              </q-card>
          </q-menu>
      </q-btn>
  </div>
</template>

<script>
import { defineComponent } from 'vue'
import { tdc } from '../../boot/app'
import { AuthStore, UserStore } from '../../stores/AuthStore'


export default defineComponent({

  setup () {
    const User = UserStore()
    const Auth = AuthStore()
    return {
      User,
      Auth
    }
  },
  props: {

  },

  data () {
    return {
      tdc: tdc
    }
  },
  created () {
  },
  computed: {
  },
  mounted () {
    this.Auth.getTipoEntidades()

  },

  methods: {
    getHostname (tipoEnt) {
      let domain = window.location.href.split('/')[2].split('.')[0]
      if (domain === 'www') {
        domain = window.location.href.split('/')[2].split('.')[1]
      }
      if (domain.toLocaleLowerCase() !== tipoEnt.nome.toLowerCase()) {
        return true
      } else {
        this.User.TipoEntidade =  tipoEnt
        setStorage('c', 'tipoEntidade', JSON.stringify(tipoEnt))
        return false
      }
    },

    selectteidadeLink(x){
      console.log(x)
      window.open(x.nome+'/', '_blank')
    }

  }
})
</script>
